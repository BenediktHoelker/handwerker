specVersion: '2.6'
metadata:
  name: handwerker
type: application
resources:
  configuration:
    paths:
      webapp: app
framework:
  name: SAPUI5
  version: '1.108.11'
  libraries:
    - name: sap.m
    - name: sap.tnt
    - name: sap.ui.core
    - name: sap.ui.comp
    - name: sap.ui.layout
    - name: sap.ui.unified
    - name: sap.ushell
    - name: sap.fe.templates
    # - name: sap.ui.generic.app
    # - name: sap.suite.ui.generic.template
    - name: themelib_sap_horizon
builder:
  resources:
    excludes:
      - 'handwerker/components/businesspartners'
      - 'handwerker/components/equipments'
  customTasks:
    - name: ui5-tooling-transpile-task
      afterTask: replaceVersion
      configuration: &transpileConfig
        removeConsoleStatements: true
        transpileAsync: true
        transpileTypeScript: true
    - name: ui5-tooling-modules-task
      afterTask: ui5-tooling-transpile-task
    - name: ui5-task-pwa-enabler
      afterTask: generateVersionInfo
      configuration:
        serviceWorker:
          strategy: Advanced-Caching
          offlinePage: offline.html
          preCache:
            - 'controller/*'
            - '*.html'
            - 'view/*'
            - 'images/*'
          networkFirst:
            - /\/api\/.*/
          avoidCaching:
            - /\/realtime-api\/.*/
        manifest:
          short_name: Handwerker
          name: HWK
          description: Manage your Handwerker-Business
          icons:
            - src: images/iot_logo_192.png
              type: image/png
              sizes: 192x192
            - src: images/iot_logo_512.png
              type: image/png
              sizes: 512x512
          start_url: /index.html
          scope: /
          background_color: '#EFF4F9'
          theme_color: '#3F5161'
          display: standalone
server:
  customMiddleware:
    - name: '@elevatory/odata-typify-middleware'
      beforeMiddleware: compression
    - name: ui5-tooling-transpile-middleware
      afterMiddleware: compression
      configuration: *transpileConfig
    - name: ui5-tooling-modules-middleware
      afterMiddleware: compression
    - name: ui5-middleware-simpleproxy
      afterMiddleware: compression
      mountPath: /v2/handwerker
      configuration:
        baseUri: http://localhost:4004/v2/handwerker
    - name: ui5-middleware-simpleproxy
      afterMiddleware: compression
      mountPath: /handwerker
      configuration:
        baseUri: http://localhost:4004/handwerker
